{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\loveText.js"],"names":["cc","Class","extends","Component","properties","textBg","SpriteFrame","loveTextJson","JsonAsset","mainText","Label","winEffect","type","AudioClip","default","clickEffect","popWindow","node","position","v2","getComponent","Sprite","spriteFrame","randLetter","playLoveText","playWinEffect","randNumber","Math","floor","random","length","fullText","json","textData","randText","string","sys","localStorage","setItem","textAppear","lastText","getItem","TextClose","audioEngine","playEffect","playClickEffect"],"mappings":";;;;;;AACAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,gBAAQ,CAACL,GAAGM,WAAJ,CADA;AAERC,sBAAcP,GAAGQ,SAFT;AAGRC,kBAAUT,GAAGU,KAHL;AAIRC,mBAAW;AACPC,kBAAMZ,GAAGa,SADF;AAEPC,qBAAS;AAFF,SAJH;AAQRC,qBAAa;AACTH,kBAAMZ,GAAGa,SADA;AAETC,qBAAS;AAFA;AARL,KAHP;;AAiBLE,aAjBK,uBAiBO;AACR;AACA,aAAKC,IAAL,CAAUC,QAAV,GAAqBlB,GAAGmB,EAAH,CAAM,CAAN,EAAS,EAAT,CAArB,CAFQ,CAE2B;AACnC,aAAKF,IAAL,CAAUG,YAAV,CAAuBpB,GAAGqB,MAA1B,EAAkCC,WAAlC,GAAgD,KAAKC,UAAL,EAAhD;AACA,aAAKC,YAAL;AACA,aAAKC,aAAL;AACH,KAvBI;AAyBLF,cAzBK,wBAyBQ;AACT;AACA,YAAIG,aAAaC,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,KAAKxB,MAAL,CAAYyB,MAAvC,CAAjB;AACA,eAAO,KAAKzB,MAAL,CAAYqB,UAAZ,CAAP;AACH,KA7BI;AA+BLF,gBA/BK,0BA+BU;AACX;AACA;AACA;AACA;AACA,aAAKO,QAAL,GAAgB,KAAKxB,YAAL,CAAkByB,IAAlB,CAAuBC,QAAvC,CALW,CAKsC;AACjD,YAAIC,WAAW,KAAKH,QAAL,CAAcJ,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,KAAKE,QAAL,CAAcD,MAAzC,CAAd,CAAf;AACA,aAAKrB,QAAL,CAAc0B,MAAd,GAAuBD,QAAvB;AACAlC,WAAGoC,GAAH,CAAOC,YAAP,CAAoBC,OAApB,CAA4B,UAA5B,EAAwCJ,QAAxC;AACH,KAxCI;;;AA0CL;;;;;;;;AAUAK,cApDK,wBAoDQ;AACT,YAAIC,WAAWxC,GAAGoC,GAAH,CAAOC,YAAP,CAAoBI,OAApB,CAA4B,UAA5B,CAAf;AACA,YAAID,YAAY,IAAhB,EAAsB;AAClBA,uBAAW,YAAX;AACH;AACD,aAAK/B,QAAL,CAAc0B,MAAd,GAAuBK,QAAvB;AACA,aAAKvB,IAAL,CAAUC,QAAV,GAAqBlB,GAAGmB,EAAH,CAAM,CAAN,EAAS,EAAT,CAArB;AACH,KA3DI;AA6DLuB,aA7DK,uBA6DO;AACR;AACA,aAAKzB,IAAL,CAAUC,QAAV,GAAqBlB,GAAGmB,EAAH,CAAM,IAAN,EAAY,CAAZ,CAArB;AACH,KAhEI;AAkELM,iBAlEK,2BAkEW;AACZzB,WAAG2C,WAAH,CAAeC,UAAf,CAA0B,KAAKjC,SAA/B;AACH,KApEI;AAqELkC,mBArEK,6BAqEa;AACd7C,WAAG2C,WAAH,CAAeC,UAAf,CAA0B,KAAK7B,WAA/B;AACH;AAvEI;;AAyEL;AAzEJ","file":"loveText.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        textBg: [cc.SpriteFrame],\r\n        loveTextJson: cc.JsonAsset,\r\n        mainText: cc.Label,\r\n        winEffect: {\r\n            type: cc.AudioClip,\r\n            default: null,\r\n        },\r\n        clickEffect: {\r\n            type: cc.AudioClip,\r\n            default: null,\r\n        },\r\n    },\r\n\r\n    popWindow() {\r\n        // 用来弹出文本框\r\n        this.node.position = cc.v2(0, 20); // 这里是相对父节点的坐标系\r\n        this.node.getComponent(cc.Sprite).spriteFrame = this.randLetter();\r\n        this.playLoveText();\r\n        this.playWinEffect();\r\n    },\r\n\r\n    randLetter() {\r\n        // 随机选择信纸\r\n        let randNumber = Math.floor(Math.random() * this.textBg.length);\r\n        return this.textBg[randNumber];\r\n    },\r\n\r\n    playLoveText() {\r\n        //\r\n        //TODD: 输出情话\r\n        //两个数组，一个用来存放还没出现过的文字下标，一个用来存放已经出现过的文字下标,然后将其存入缓存就行了\r\n        //\r\n        this.fullText = this.loveTextJson.json.textData; // 得到全部的文本\r\n        let randText = this.fullText[Math.floor(Math.random() * this.fullText.length)];\r\n        this.mainText.string = randText;\r\n        cc.sys.localStorage.setItem(\"lastText\", randText);\r\n    },\r\n\r\n    /*getText(){\r\n        let textData = JSON.parse(cc.sys.localStorage.getItem(\"loveText\")); \r\n        if( textData == null){\r\n            cc.sys.localStorage.setItem(\"loveText\",JSON.stringify(this.loveTextJson));\r\n        }\r\n\r\n        return textData.json;\r\n\r\n    },*/\r\n\r\n    textAppear() {\r\n        let lastText = cc.sys.localStorage.getItem(\"lastText\");\r\n        if (lastText == null) {\r\n            lastText = \"还没有解锁过情话哦。\";\r\n        }\r\n        this.mainText.string = lastText;\r\n        this.node.position = cc.v2(0, 20);\r\n    },\r\n\r\n    TextClose() {\r\n        // 这个函数实现“假”关闭文本框，因为只是将文本框移出可见范围\r\n        this.node.position = cc.v2(1500, 0);\r\n    },\r\n\r\n    playWinEffect() {\r\n        cc.audioEngine.playEffect(this.winEffect);\r\n    },\r\n    playClickEffect() {\r\n        cc.audioEngine.playEffect(this.clickEffect);\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}