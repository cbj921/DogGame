{"version":3,"sources":["loveText.js"],"names":["cc","Class","extends","Component","properties","textBg","SpriteFrame","loveTextJson","JsonAsset","mainText","Label","popWindow","node","position","v2","getComponent","Sprite","spriteFrame","randLetter","playLoveText","randNumber","Math","floor","random","length","fullText","json","textData","randText","string","sys","localStorage","setItem","textAppear","lastText","getItem","TextClose","start"],"mappings":";;;;;;AACAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,gBAAO,CAACL,GAAGM,WAAJ,CADC;AAERC,sBAAcP,GAAGQ,SAFT;AAGRC,kBAAUT,GAAGU;AAHL,KAHP;;AASLC,aATK,uBASM;AACP;AACA,aAAKC,IAAL,CAAUC,QAAV,GAAqBb,GAAGc,EAAH,CAAM,CAAN,EAAQ,EAAR,CAArB,CAFO,CAE2B;AAClC,aAAKF,IAAL,CAAUG,YAAV,CAAuBf,GAAGgB,MAA1B,EAAkCC,WAAlC,GAAgD,KAAKC,UAAL,EAAhD;AACA,aAAKC,YAAL;AACH,KAdI;AAgBLD,cAhBK,wBAgBO;AACR;AACA,YAAIE,aAAaC,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,KAAKlB,MAAL,CAAYmB,MAAvC,CAAjB;AACA,eAAO,KAAKnB,MAAL,CAAYe,UAAZ,CAAP;AACH,KApBI;AAsBLD,gBAtBK,0BAsBS;AACV;AACA;AACA;AACA;AACA,aAAKM,QAAL,GAAgB,KAAKlB,YAAL,CAAkBmB,IAAlB,CAAuBC,QAAvC,CALU,CAKuC;AACjD,YAAIC,WAAW,KAAKH,QAAL,CAAcJ,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,KAAKE,QAAL,CAAcD,MAAzC,CAAd,CAAf;AACA,aAAKf,QAAL,CAAcoB,MAAd,GAAuBD,QAAvB;AACA5B,WAAG8B,GAAH,CAAOC,YAAP,CAAoBC,OAApB,CAA4B,UAA5B,EAAuCJ,QAAvC;AACH,KA/BI;;;AAiCL;;;;;;;;AAUAK,cA3CK,wBA2CO;AACR,YAAIC,WAAWlC,GAAG8B,GAAH,CAAOC,YAAP,CAAoBI,OAApB,CAA4B,UAA5B,CAAf;AACA,YAAGD,YAAY,IAAf,EAAoB;AAChBA,uBAAW,YAAX;AACH;AACD,aAAKzB,QAAL,CAAcoB,MAAd,GAAuBK,QAAvB;AACA,aAAKtB,IAAL,CAAUC,QAAV,GAAqBb,GAAGc,EAAH,CAAM,CAAN,EAAQ,EAAR,CAArB;AACH,KAlDI;AAoDLsB,aApDK,uBAoDM;AACP;AACA,aAAKxB,IAAL,CAAUC,QAAV,GAAqBb,GAAGc,EAAH,CAAM,IAAN,EAAW,CAAX,CAArB;AACH,KAvDI;AAyDLuB,SAzDK,mBAyDI;AACL;AACA;AACH;AA5DI;;AA8DL;AA9DJ","file":"loveText.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        textBg:[cc.SpriteFrame],\r\n        loveTextJson: cc.JsonAsset,\r\n        mainText: cc.Label,\r\n    },\r\n\r\n    popWindow(){\r\n        // 用来弹出文本框\r\n        this.node.position = cc.v2(0,20); // 这里是相对父节点的坐标系\r\n        this.node.getComponent(cc.Sprite).spriteFrame = this.randLetter(); \r\n        this.playLoveText();\r\n    },\r\n\r\n    randLetter(){\r\n        // 随机选择信纸\r\n        let randNumber = Math.floor(Math.random() * this.textBg.length);\r\n        return this.textBg[randNumber];\r\n    },\r\n\r\n    playLoveText(){\r\n        //\r\n        //TODD: 输出情话\r\n        //两个数组，一个用来存放还没出现过的文字下标，一个用来存放已经出现过的文字下标,然后将其存入缓存就行了\r\n        //\r\n        this.fullText = this.loveTextJson.json.textData; // 得到全部的文本\r\n        let randText = this.fullText[Math.floor(Math.random() * this.fullText.length)];\r\n        this.mainText.string = randText;\r\n        cc.sys.localStorage.setItem(\"lastText\",randText);\r\n    },\r\n\r\n    /*getText(){\r\n        let textData = JSON.parse(cc.sys.localStorage.getItem(\"loveText\")); \r\n        if( textData == null){\r\n            cc.sys.localStorage.setItem(\"loveText\",JSON.stringify(this.loveTextJson));\r\n        }\r\n\r\n        return textData.json;\r\n\r\n    },*/\r\n\r\n    textAppear(){\r\n        let lastText = cc.sys.localStorage.getItem(\"lastText\");\r\n        if(lastText == null){\r\n            lastText = \"还没有解锁过情话哦。\";\r\n        }\r\n        this.mainText.string = lastText;\r\n        this.node.position = cc.v2(0,20);\r\n    },\r\n\r\n    TextClose(){\r\n        // 这个函数实现“假”关闭文本框，因为只是将文本框移出可见范围\r\n        this.node.position = cc.v2(1500,0);\r\n    },\r\n\r\n    start () {\r\n        //cc.log(this.textBg[1]);\r\n        //cc.log(this.loveTextJson.json.textData);\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}