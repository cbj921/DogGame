{"version":3,"sources":["dog.js"],"names":["DOGSTATE","cc","Enum","SLEEP","STAND","RUN","EAT","Class","extends","Component","properties","dog","Sprite","dogAnimation","Animation","dogSleepPicture","SpriteFrame","dogShakePicture","randStateNum","duration","textLabel","require","init","gameCtl","setDogSleep","node","on","Node","EventType","TOUCH_START","dogTouchFunc","spriteFrame","dogState","nowTime","Date","playText","labelFlag","touchInSleep","touchInStand","touchInRun","touchInEat","scheduleOnce","play","randNum","Math","random","happyRun","log","runDistance","runLeft","moveBy","v2","runRight","runAction","onLoad","update","dt","laterTime","labelActive"],"mappings":"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","file":"dog.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["const DOGSTATE = cc.Enum({\r\n    SLEEP: -1,\r\n    STAND: -1,\r\n    RUN: -1,\r\n    EAT: -1,\r\n});\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        dog: cc.Sprite,\r\n        dogAnimation: cc.Animation,\r\n        dogSleepPicture: cc.SpriteFrame,\r\n        dogShakePicture: cc.SpriteFrame,\r\n        randStateNum: 0, // 该值只能在0-1之间,用来在 touchInStand() 中决定触摸后状态\r\n        duration: 0,\r\n        textLabel: require(\"textLabel\"),\r\n    },\r\n\r\n    init(gameCtl) {\r\n        this.gameCtl = gameCtl;\r\n        this.setDogSleep();\r\n        this.node.on(cc.Node.EventType.TOUCH_START, this.dogTouchFunc, this);\r\n    },\r\n\r\n    setDogSleep() {\r\n        this.dog.spriteFrame = this.dogSleepPicture;\r\n        this.dogState = DOGSTATE.SLEEP;\r\n    },\r\n\r\n    // 处理触摸狗的事件\r\n    dogTouchFunc() {\r\n        this.nowTime = new Date(); // 用来记录触摸时的时间\r\n        this.textLabel.playText(this.dogState);\r\n        this.labelFlag = 1; // 1 表示文本框的 active == true\r\n\r\n        if (this.dogState == DOGSTATE.SLEEP) {\r\n            this.touchInSleep();\r\n        } else if (this.dogState == DOGSTATE.STAND) {\r\n            this.touchInStand();\r\n        } else if (this.dogState == DOGSTATE.RUN) {\r\n            this.touchInRun();\r\n        } else if (this.dogState == DOGSTATE.EAT) {\r\n            this.touchInEat();\r\n        }\r\n\r\n    },\r\n\r\n    touchInSleep() {\r\n        this.dogState = DOGSTATE.STAND;\r\n        this.dog.spriteFrame = this.dogShakePicture;\r\n        this.dogAnimation.scheduleOnce(() => {\r\n            this.dogAnimation.play(\"stand\");\r\n        }, 0.5);\r\n    },\r\n\r\n    touchInStand() {\r\n        let randNum = 0;\r\n        randNum = Math.random(); // 利用随机数来决定 stand 状态下被触摸后干嘛\r\n        // 有两种情况，一种是触摸后乱跑，一种是触摸后显示文字\r\n        if (randNum > this.randStateNum) {\r\n            // 乱跑情况\r\n            this.happyRun();\r\n        } else {\r\n            //this.textLabel.playText(this.dogState);\r\n        }\r\n    },\r\n\r\n    touchInRun() {\r\n        // 不要跑动时点击动画\r\n        cc.log(\"run\");\r\n    },\r\n\r\n    touchInEat() {\r\n        \r\n    },\r\n\r\n    happyRun() { // 这里的代码可以用，但是很奇怪，需要优化 \r\n        this.dogState = DOGSTATE.RUN;\r\n        let runDistance = Math.random() + 0.2;\r\n        let runLeft = cc.moveBy(this.duration, cc.v2(-runDistance * 300, 0));\r\n        let runRight = cc.moveBy(this.duration, cc.v2(runDistance * 300, 0));\r\n        if (Math.random() > 0.5) {\r\n            this.dogAnimation.play(\"runLeft\");\r\n            this.node.runAction(runLeft);\r\n            this.dogAnimation.scheduleOnce(()=>{\r\n                this.dogAnimation.play(\"runRight\");\r\n                this.node.runAction(runRight);\r\n            },this.duration);\r\n\r\n        } else {\r\n            this.dogAnimation.play(\"runRight\");\r\n            this.node.runAction(runRight);\r\n            this.dogAnimation.scheduleOnce(()=>{\r\n                this.dogAnimation.play(\"runLeft\");\r\n                this.node.runAction(runLeft);\r\n            },this.duration);\r\n        }\r\n        this.dogAnimation.scheduleOnce(()=>{\r\n            this.dogAnimation.play(\"stand\");\r\n            this.dogState = DOGSTATE.STAND;\r\n        },2*this.duration+0.1); // 需要等待两个 duration 才能执行\r\n    },\r\n\r\n    onLoad() {\r\n        //cc.log(this.dogAnimation);\r\n        //this.dogAnimation.play(\"runRight\");\r\n\r\n    },\r\n\r\n    update(dt){\r\n        // 以下功能用来隐藏文本框\r\n        if(this.labelFlag){\r\n            this.laterTime = new Date();\r\n            if(this.laterTime - this.nowTime >= 5000){\r\n                this.textLabel.labelActive(false);\r\n                this.labelFlag = 0;\r\n            }\r\n        }\r\n        // 到此\r\n\r\n\r\n    },\r\n\r\n});\r\n"]}