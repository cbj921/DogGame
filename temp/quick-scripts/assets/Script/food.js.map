{"version":3,"sources":["food.js"],"names":["cc","Class","extends","Component","properties","textLabel","Label","hungryLabel","textLabelScript","require","loveText","init","getHungryLevel","calcHungryLevel","string","node","active","feedFood","labelActive","popWindow","firstTime","Date","sys","localStorage","setItem","lastFeedTime","getItem","nowTime","hungryNumber","Math","floor","hungry","onLoad","start"],"mappings":";;;;;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,mBAAWL,GAAGM,KADN;AAERC,qBAAaP,GAAGM,KAFR;AAGRE,yBAAkBC,QAAQ,WAAR,CAHV;AAIRC,kBAAUD,QAAQ,UAAR;AAJF,KAHP;;AAULE,QAVK,kBAUC;AACF,aAAKC,cAAL;AACA,aAAKC,eAAL;AACA,YAAG,KAAKN,WAAL,CAAiBO,MAAjB,IAA2B,CAA9B,EAAgC;AAC5B,iBAAKC,IAAL,CAAUC,MAAV,GAAmB,KAAnB;AACH,SAFD,MAGK;AACD,iBAAKD,IAAL,CAAUC,MAAV,GAAmB,IAAnB;AACH;AACJ,KAnBI;AAqBLC,YArBK,sBAqBK;AACN,YAAG,KAAKV,WAAL,CAAiBO,MAAjB,IAA2B,CAA9B,EAAgC;AAC5B,iBAAKC,IAAL,CAAUC,MAAV,GAAmB,IAAnB;AACA,iBAAKR,eAAL,CAAqBU,WAArB,CAAiC,IAAjC;AACA,iBAAKb,SAAL,CAAeS,MAAf,GAAwB,WAAxB;AACA,iBAAKP,WAAL,CAAiBO,MAAjB,GAA0B,GAA1B;AACA;AACA;AACA,iBAAKJ,QAAL,CAAcS,SAAd;AACA;AACA,gBAAIC,YAAY,IAAIC,IAAJ,EAAhB;AACArB,eAAGsB,GAAH,CAAOC,YAAP,CAAoBC,OAApB,CAA4B,eAA5B,EAA4CJ,SAA5C;AACApB,eAAGsB,GAAH,CAAOC,YAAP,CAAoBC,OAApB,CAA4B,aAA5B,EAA0C,KAAKjB,WAAL,CAAiBO,MAA3D;AACH,SAZD,MAaI;AACA,iBAAKN,eAAL,CAAqBU,WAArB,CAAiC,IAAjC;AACA,iBAAKb,SAAL,CAAeS,MAAf,GAAwB,aAAxB;AACH;AACJ,KAvCI;AAyCLD,mBAzCK,6BAyCY;AACb;AACA,YAAIY,eAAe,IAAIJ,IAAJ,CAASrB,GAAGsB,GAAH,CAAOC,YAAP,CAAoBG,OAApB,CAA4B,eAA5B,CAAT,CAAnB,CAFa,CAE8D;AAC3E,YAAGD,gBAAgB,IAAnB,EAAyB;AACrB,iBAAKlB,WAAL,CAAiBO,MAAjB,GAA0B,CAA1B;AACA;AACH;AACD,aAAKF,cAAL;;AAEA,YAAIe,UAAW,IAAIN,IAAJ,EAAf;AACA,YAAIO,eAAeC,KAAKC,KAAL,CAAY,CAACH,UAAUF,YAAX,IAAyB,IAAzB,GAA8B,IAA/B,GAAuC,EAAlD,CAAnB;AACA,aAAKlB,WAAL,CAAiBO,MAAjB,IAA2Bc,YAA3B;AACA,YAAG,KAAKrB,WAAL,CAAiBO,MAAjB,GAA0B,CAA7B,EAA+B;AAC3B,iBAAKP,WAAL,CAAiBO,MAAjB,GAA0B,CAA1B;AACH;AAEJ,KAzDI;AA2DLF,kBA3DK,4BA2DW;AACZ,YAAImB,SAAS/B,GAAGsB,GAAH,CAAOC,YAAP,CAAoBG,OAApB,CAA4B,aAA5B,CAAb;AACA,YAAGK,UAAU,IAAb,EAAkB;AACd,iBAAKxB,WAAL,CAAiBO,MAAjB,GAA0B,CAA1B;AACH,SAFD,MAGI;AACA,iBAAKP,WAAL,CAAiBO,MAAjB,GAA0BiB,MAA1B;AACH;AACJ,KAnEI;AAqELC,UArEK,oBAqEI,CAER,CAvEI;AAyELC,SAzEK,mBAyEI,CAER;AA3EI;;AA6EL;AA7EJ","file":"food.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        textLabel: cc.Label,\r\n        hungryLabel: cc.Label,\r\n        textLabelScript : require(\"textLabel\"),\r\n        loveText: require(\"loveText\"),\r\n    },\r\n\r\n    init(){\r\n        this.getHungryLevel();\r\n        this.calcHungryLevel();\r\n        if(this.hungryLabel.string == 0){\r\n            this.node.active = false;\r\n        }\r\n        else {\r\n            this.node.active = true;\r\n        }\r\n    },\r\n\r\n    feedFood(){\r\n        if(this.hungryLabel.string == 0){\r\n            this.node.active = true;\r\n            this.textLabelScript.labelActive(true);\r\n            this.textLabel.string = \"主人真好！好香哦！\";\r\n            this.hungryLabel.string = 100;\r\n            //\r\n            // TODO:调用情话文本框输出\r\n            this.loveText.popWindow();\r\n            //\r\n            let firstTime = new Date();\r\n            cc.sys.localStorage.setItem(\"feedFirstTime\",firstTime);\r\n            cc.sys.localStorage.setItem(\"hungryLevel\",this.hungryLabel.string);\r\n        }\r\n        else{\r\n            this.textLabelScript.labelActive(true);\r\n            this.textLabel.string = \"人家碗里的还没吃完哦.\";\r\n        }\r\n    },\r\n\r\n    calcHungryLevel(){\r\n        // 计算饱食度\r\n        let lastFeedTime = new Date(cc.sys.localStorage.getItem(\"feedFirstTime\")); // 这里的lastFeedTime 为 string 类型,要转换成object 类型\r\n        if(lastFeedTime == null) {\r\n            this.hungryLabel.string = 0;\r\n            //cc.log(\"没有获取到时间\");\r\n        };\r\n        this.getHungryLevel();\r\n\r\n        let nowTime  = new Date();\r\n        let hungryNumber = Math.floor(((nowTime - lastFeedTime)/1000/3600) * 20);\r\n        this.hungryLabel.string -= hungryNumber;\r\n        if(this.hungryLabel.string < 0){\r\n            this.hungryLabel.string = 0;\r\n        }\r\n\r\n    },\r\n\r\n    getHungryLevel(){\r\n        let hungry = cc.sys.localStorage.getItem(\"hungryLevel\");\r\n        if(hungry == null){\r\n            this.hungryLabel.string = 0;\r\n        }\r\n        else{\r\n            this.hungryLabel.string = hungry;\r\n        }\r\n    },\r\n\r\n    onLoad (){\r\n        \r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}